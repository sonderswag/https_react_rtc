<!DOCTYPE html><html><head><title>Agora Web Sample</title><link rel="stylesheet" href="vendor/bootstrap.min.css"><script src="AgoraRTCSDK-2.3.1.js"></script><script src="vendor/jquery.js"></script><link href="/https_react_rtc/static/css/main.c17080f1.css" rel="stylesheet"></head><body><div id="div_device" class="panel panel-default"><div class="select"><label for="audioSource">Audio source:</label><select id="audioSource"></select></div><div class="select"><label for="videoSource">Video source:</label><select id="videoSource"></select></div></div><div id="div_join" class="panel panel-default"><div class="panel-body">Key: <input id="key" size="36">Channel: <input id="channel" value="1000" size="4">Host: <input id="video" type="checkbox" checked="checked"><button id="join" class="btn btn-primary" onclick="join()">Join</button> <button id="leave" class="btn btn-primary" onclick="leave()">Leave</button> <button id="publish" class="btn btn-primary" onclick="publish()">Publish</button> <button id="unpublish" class="btn btn-primary" onclick="unpublish()">Unpublish</button></div></div><div id="video" style="margin:0 auto"><div id="agora_local" style="float:right;width:210px;height:147px;display:inline-block"></div></div><script>var client,localStream,camera,microphone;AgoraRTC.checkSystemRequirements()||alert("browser is no support webRTC"),AgoraRTC.Logger.error("this is error"),AgoraRTC.Logger.warning("this is warning"),AgoraRTC.Logger.info("this is info"),AgoraRTC.Logger.debug("this is debug");var audioSelect=document.querySelector("select#audioSource"),videoSelect=document.querySelector("select#videoSource");function join(){document.getElementById("join").disabled=!0,document.getElementById("video").disabled=!0;console.log("Init AgoraRTC client with vendor key: "+key.value),(client=AgoraRTC.createClient({mode:"interop"})).init(key.value,function(){console.log("AgoraRTC client initialized"),client.join(null,channel.value,null,function(e){console.log("User "+e+" join channel successfully"),document.getElementById("video").checked&&(camera=videoSource.value,microphone=audioSource.value,localStream=AgoraRTC.createStream({streamID:e,audio:!0,cameraId:camera,microphoneId:microphone,video:document.getElementById("video").checked,screen:!1}),document.getElementById("video").checked&&localStream.setVideoProfile("720p_3"),localStream.on("accessAllowed",function(){console.log("accessAllowed")}),localStream.on("accessDenied",function(){console.log("accessDenied")}),localStream.init(function(){console.log("getUserMedia successfully"),localStream.play("agora_local"),client.publish(localStream,function(e){console.log("Publish local stream error: "+e)}),client.on("stream-published",function(e){console.log("Publish local stream successfully")})},function(e){console.log("getUserMedia failed",e)}))},function(e){console.log("Join channel failed",e)})},function(e){console.log("AgoraRTC client init failed",e)}),channelKey="",client.on("error",function(e){console.log("Got error msg:",e.reason),"DYNAMIC_KEY_TIMEOUT"===e.reason&&client.renewChannelKey(channelKey,function(){console.log("Renew channel key successfully")},function(e){console.log("Renew channel key failed: ",e)})}),client.on("stream-added",function(e){var o=e.stream;console.log("New stream added: "+o.getId()),console.log("Subscribe ",o),client.subscribe(o,function(e){console.log("Subscribe stream failed",e)})}),client.on("stream-subscribed",function(e){var o=e.stream;console.log("Subscribe remote stream successfully: "+o.getId()),0===$("div#video #agora_remote"+o.getId()).length&&$("div#video").append('<div id="agora_remote'+o.getId()+'" style="float:left; width:810px;height:607px;display:inline-block;"></div>'),o.play("agora_remote"+o.getId())}),client.on("stream-removed",function(e){var o=e.stream;o.stop(),$("#agora_remote"+o.getId()).remove(),console.log("Remote stream is removed "+o.getId())}),client.on("peer-leave",function(e){var o=e.stream;o&&(o.stop(),$("#agora_remote"+o.getId()).remove(),console.log(e.uid+" leaved from this channel"))})}function leave(){document.getElementById("leave").disabled=!0,client.leave(function(){console.log("Leavel channel successfully")},function(e){console.log("Leave channel failed")})}function publish(){document.getElementById("publish").disabled=!0,document.getElementById("unpublish").disabled=!1,client.publish(localStream,function(e){console.log("Publish local stream error: "+e)})}function unpublish(){document.getElementById("publish").disabled=!1,document.getElementById("unpublish").disabled=!0,client.unpublish(localStream,function(e){console.log("Unpublish local stream failed"+e)})}function getDevices(){AgoraRTC.getDevices(function(e){for(var o=0;o!==e.length;++o){var l=e[o],n=document.createElement("option");n.value=l.deviceId,"audioinput"===l.kind?(n.text=l.label||"microphone "+(audioSelect.length+1),audioSelect.appendChild(n)):"videoinput"===l.kind?(n.text=l.label||"camera "+(videoSelect.length+1),videoSelect.appendChild(n)):console.log("Some other kind of source/device: ",l)}})}getDevices()</script><script type="text/javascript" src="/https_react_rtc/static/js/main.23d4d444.js"></script></body></html>